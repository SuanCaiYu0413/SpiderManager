{% extends 'base-head.html' %}

{% block body %}
    <div class="x-body layui-anim layui-anim-up">
        <blockquote class="layui-elem-quote" id="time_data">
        </blockquote>
        <fieldset class="layui-elem-field">
            <legend>打包文件</legend>
            <div class="layui-field-box">
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-body">
                            <div class="layui-carousel x-admin-carousel x-admin-backlog" lay-anim=""
                                 lay-indicator="inside"
                                 lay-arrow="none" style="width: 100%; height: 90px;">
                                <ul class="layui-row layui-col-space10 layui-this" id="data_area">
                                    <li class="layui-col-xs2">
                                        {#                                上传文件#}
                                        <div class="layui-upload biangeng_3_1">
                                            <button type="button" class="layui-btn" id="egg_file"><i
                                                    class="layui-icon">&#xe67c;</i>打包文件
                                            </button>
                                            <div class="layui-upload-list">
                                                <img class="egg_file_preview" id="egg_file_preview">
                                                <!-- <p id="demoText"></p>-->
                                            </div>
                                        </div>
                                    </li>
                                    {#                                    项目名称#}
                                    <li class="layui-col-xs2">

                                        <div class="layui-input-inline">
                                            <input type="text" id="host_name" name="host_name" required=""
                                                   lay-verify="required"
                                                   autocomplete="off" class="layui-input" placeholder="输入项目名称">
                                        </div>

                                    </li>
                                    {#                                    提交按钮#}
                                    <li class="layui-col-xs2">

                                        <button class="layui-btn" lay-filter="add" lay-submit="" id="add">
                                            上传
                                        </button>

                                    </li>
                                </ul>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>


        <script>
            layui.use('upload', function () {
                var csrf_token = "{{ csrf_token() }}";

            $.ajaxSetup({
                beforeSend: function(xhr, settings) {
                    if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrf_token);
                    }
                }
            });

                var upload = layui.upload;

                //执行实例
                var uploadInst = upload.render({
                    elem: '#egg_file' //绑定元素
                    , url: './upload_project' //上传接口

                    , done: function (res) {
                        //上传完毕回调
                        $('#egg_file_preview').attr('src', 'C:\\Users\\Administrator\\Desktop\\上传文件' + data.data);
                        layer.msg('上传成功！');
                    }
                    , error: function () {
                        layer.msg('上传失败');
                    }
                });
            });
        </script>
{% endblock %}